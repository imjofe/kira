import 'package:flutter_test/flutter_test.dart';
import 'package:sqflite_common_ffi/sqflite_ffi.dart';
import 'package:kira_flutter_client/services/db_service.dart';

void main() {
  // Initialize FFI
  sqfliteFfiInit();

  // Set the database factory to FFI
  databaseFactory = databaseFactoryFfi;

  test('DbService CRUD operations work correctly', () async {
    final dbService = DbService();
    // await dbService.init();

    // Test insert
    // final id = await dbService.insertTask({
    //   'title': 'Test Task',
    //   'startTime': DateTime.now().toIso8601String(),
    //   'endTime': DateTime.now().add(const Duration(hours: 1)).toIso8601String(),
    //   'status': 'pending',
    // });
    // expect(id, isNotNull);

    // Test get
    // final tasks = await dbService.getTasks();
    // expect(tasks, isNotEmpty);
    // expect(tasks.first['title'], 'Test Task');

    // Test update
    // await dbService.updateTask(id, {'status': 'completed'});
    // final updatedTasks = await dbService.getTasks();
    // expect(updatedTasks.first['status'], 'completed');

    // Test delete
    // await dbService.deleteTask(id);
    // final remainingTasks = await dbService.getTasks();
    // expect(remainingTasks, isEmpty);
  });
}
